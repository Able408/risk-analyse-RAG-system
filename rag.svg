<svg width="900" height="650" xmlns="http://www.w3.org/2000/svg" font-family="sans-serif">
    <defs>
        <style>
            .box {
                stroke: #4a5568;
                stroke-width: 1.5;
                rx: 8;
                ry: 8;
                transition: all 0.3s ease;
            }
            .llm-box {
                fill: #e9d8fd;
            }
            .data-box {
                fill: #d1eaf7;
            }
            .process-box {
                fill: #d4f0e0;
            }
            .io-box {
                fill: #fefcbf;
            }
            .text {
                font-size: 13px;
                fill: #2d3748;
                text-anchor: middle;
                dominant-baseline: middle;
            }
            .title-text {
                font-size: 11px;
                font-weight: bold;
                fill: #718096;
                text-anchor: middle;
            }
            .arrow {
                stroke: #718096;
                stroke-width: 1.5;
                fill: none;
            }
            .arrow-head {
                fill: #718096;
            }
        </style>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" class="arrow-head" />
        </marker>
    </defs>

    <!-- Nodes -->
    <g id="node-input">
        <rect x="375" y="20" width="150" height="60" class="box io-box" />
        <text x="450" y="50" class="text">用户上传图片</text>
    </g>

    <g id="node-desc">
        <rect x="375" y="120" width="150" height="60" class="box llm-box" />
        <text x="450" y="140" class="title-text">步骤 1</text>
        <text x="450" y="160" class="text">生成图像描述</text>
    </g>

    <g id="node-candidate">
        <rect x="150" y="220" width="180" height="60" class="box process-box" />
        <text x="240" y="240" class="title-text">步骤 1.5</text>
        <text x="240" y="260" class="text">生成候选风险源</text>
    </g>

    <g id="node-verify">
        <rect x="360" y="220" width="180" height="60" class="box llm-box" />
        <text x="450" y="240" class="title-text">步骤 1.6</text>
        <text x="450" y="260" class="text">LLM 视觉验证</text>
    </g>

    <g id="node-retrieve">
        <rect x="570" y="220" width="180" height="60" class="box data-box" />
        <text x="660" y="240" class="title-text">步骤 2</text>
        <text x="660" y="260" class="text">检索法规文档</text>
    </g>

    <g id="node-filter">
        <rect x="570" y="320" width="180" height="60" class="box process-box" />
        <text x="660" y="340" class="title-text">步骤 2.5</text>
        <text x="660" y="360" class="text">过滤相关文档</text>
    </g>

    <g id="node-analysis">
        <rect x="265" y="420" width="180" height="60" class="box llm-box" />
        <text x="355" y="440" class="title-text">步骤 3a</text>
        <text x="355" y="460" class="text">生成风险识别报告</text>
    </g>

    <g id="node-measures">
        <rect x="455" y="420" width="180" height="60" class="box llm-box" />
        <text x="545" y="440" class="title-text">步骤 3b</text>
        <text x="545" y="460" class="text">生成管理措施</text>
    </g>

    <g id="node-output">
        <rect x="375" y="550" width="150" height="60" class="box io-box" />
        <text x="450" y="580" class="text">生成最终报告</text>
    </g>

    <!-- Arrows -->
    <path d="M450,80 V120" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M450,180 V200 H240 V220" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M330,250 H360" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M450,280 V300 H660 V320" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M540,250 H570" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M660,280 V320" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M660,380 V400 H355 V420" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M445,450 H455" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M355,480 V530 H450 V550" class="arrow" marker-end="url(#arrowhead)" />
    <path d="M545,480 V530 H450 V550" class="arrow" marker-end="url(#arrowhead)" />

    <!-- Legend -->
    <g transform="translate(20, 20)">
        <rect x="0" y="0" width="120" height="110" rx="5" ry="5" fill="#f8f9fa" stroke="#dee2e6" />
        <text x="60" y="15" text-anchor="middle" font-weight="bold" font-size="14px">图例</text>
        <rect x="10" y="30" width="20" height="15" class="box llm-box" />
        <text x="40" y="38" font-size="12px">LLM 处理</text>
        <rect x="10" y="55" width="20" height="15" class="box data-box" />
        <text x="40" y="63" font-size="12px">数据检索</text>
        <rect x="10" y="80" width="20" height="15" class="box process-box" />
        <text x="40" y="88" font-size="12px">常规处理</text>
    </g>
</svg>